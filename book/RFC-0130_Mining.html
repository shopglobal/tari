<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RFC-0130: Mining - The Tari Network: RFC library</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The Tari network RFC library and documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
            tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
            }
          });
        </script>
        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">var path_to_root = "";</script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var sidebar = localStorage.getItem('mdbook-sidebar');
                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = 'light';
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <img src="theme/images/tari-splash.png" class="tlu">

            <ol class="chapter"><li class="affix"><a href="about.html">About the Tari RFC documents</a></li><li><a href="RFC-0001_overview.html"><strong aria-hidden="true">1.</strong> RFC-0001: An overview of the Tari network</a></li><li><a href="RFC-0010_CodeStructure.html"><strong aria-hidden="true">2.</strong> RFC-0010: Tari code structure and organisation</a></li><li><a href="RFC-0100_BaseLayer.html"><strong aria-hidden="true">3.</strong> RFC-0100: The Tari Base Layer</a></li><li><ol class="section"><li><a href="RFC-0110_BaseNodes.html"><strong aria-hidden="true">3.1.</strong> RFC-0110: Base nodes</a></li><li><a href="RFC-0130_Mining.html" class="active"><strong aria-hidden="true">3.2.</strong> RFC-0130: Mining</a></li><li><a href="RFC-0140_Syncing_and_seeding.html"><strong aria-hidden="true">3.3.</strong> RFC-0140: Sync and Seeding</a></li><li><a href="RFC-0150_Wallets.html"><strong aria-hidden="true">3.4.</strong> RFC-0150: Wallets</a></li><li><a href="RFC-0170_NetworkCommunicationProtocol.html"><strong aria-hidden="true">3.5.</strong> RFC-0170: Network Communication Protocol</a></li></ol></li><li><a href="RFC-0200_BaseLayerExtensions.html"><strong aria-hidden="true">4.</strong> RFC-0200: Tari-specific extensions to Mimblewimble</a></li><li><ol class="section"><li><a href="RFC-0220_AssetCheckpoints.html"><strong aria-hidden="true">4.1.</strong> RFC-0220: Asset checkpoints</a></li><li><a href="RFC-0230_HTLC.html"><strong aria-hidden="true">4.2.</strong> RFC-0230: Hash time locked contracts</a></li><li><a href="RFC-0322_VNRegistration.html"><strong aria-hidden="true">4.3.</strong> RFC-0322: Validator Node Registration</a></li><li><a href="RFC-0341_AssetRegistration.html"><strong aria-hidden="true">4.4.</strong> RFC-0341: Asset registration</a></li></ol></li><li><a href="RFC-0300_DAN.html"><strong aria-hidden="true">5.</strong> RFC-0300: The Digital Assets Network</a></li><li><ol class="section"><li><a href="RFC-0301_NamespaceRegistration.html"><strong aria-hidden="true">5.1.</strong> RFC-0301: Namespace Registration</a></li></ol></li><li><a href="RFC-0320_ValidatorNodes.html"><strong aria-hidden="true">6.</strong> RFC-0320: Validator Nodes</a></li><li><ol class="section"><li><a href="RFC-0321_VNAssetDiscovery.html"><strong aria-hidden="true">6.1.</strong> RFC-0321: Asset discovery</a></li><li><a href="RFC-0322_VNRegistration.html"><strong aria-hidden="true">6.2.</strong> RFC-0322: Validator Node Registration</a></li><li><a href="RFC-0323_VNCommittees.html"><strong aria-hidden="true">6.3.</strong> RFC-0323: Validator Node committee selection</a></li><li><a href="RFC-0310_AssetTemplates.html"><strong aria-hidden="true">6.4.</strong> RFC-0310: Digital Asset templates</a></li><li><a href="RFC-0325_AssetReadAPI.html"><strong aria-hidden="true">6.5.</strong> RFC-0325: The asset read-only API</a></li></ol></li><li><a href="RFC-0340_VNConsensusOverview.html"><strong aria-hidden="true">7.</strong> RFC-0340: Validator Node Consensus</a></li><li><ol class="section"><li><a href="RFC-0341_AssetRegistration.html"><strong aria-hidden="true">7.1.</strong> RFC-0341: Asset registration</a></li><li><a href="RFC-0342_VNInstructions.html"><strong aria-hidden="true">7.2.</strong> RFC-0342: Validator node instructions</a></li><li><a href="RFC-0343_VNConsensusAlgorithm.html"><strong aria-hidden="true">7.3.</strong> RFC-0343: The VN consensus algorithm</a></li><li><a href="RFC-0344_VNAssetTransfer.html"><strong aria-hidden="true">7.4.</strong> RFC-0344: Asset transfer mechanism</a></li><li><a href="RFC-0345_VNAssetRetirement.html"><strong aria-hidden="true">7.5.</strong> RFC-0345: Asset retirement</a></li></ol></li><li><a href="RFC-0350_DisputeResolution.html"><strong aria-hidden="true">8.</strong> RFC-0350: DAN Dispute resolution mechanism</a></li><li><a href="RFC-0370_TariCollections.html"><strong aria-hidden="true">9.</strong> RFC-0370: Tari Collections</a></li><li><ol class="section"><li><a href="RFC-0371_TokenWallet.html"><strong aria-hidden="true">9.1.</strong> RFC-0371: Token wallet</a></li><li><a href="RFC-0372_TCP2PComm.html"><strong aria-hidden="true">9.2.</strong> RFC-0372: Tari Collections Peer-to-peer communication</a></li><li><a href="RFC-0373_TCInstructionAPI.html"><strong aria-hidden="true">9.3.</strong> RFC-0373: Instruction API</a></li><li><a href="RFC-0374_TCAssetManagement.html"><strong aria-hidden="true">9.4.</strong> RFC-0374: Asset Creation and management</a></li><li><a href="RFC-0375_TCWalletBridge.html"><strong aria-hidden="true">9.5.</strong> RFC-0375: Tari wallet bridge</a></li></ol></li><li><a href="RFC-0500_PaymentChannels.html"><strong aria-hidden="true">10.</strong> RFC-0500: Tari payment channels</a></li><li><ol class="section"><li><a href="RFC-0530_P2PPayments.html"><strong aria-hidden="true">10.1.</strong> RFC-0530: Peer-to-peer payments</a></li><li><a href="RFC-0550_VNFees.html"><strong aria-hidden="true">10.2.</strong> RFC-0550: Instruction fees</a></li></ol></li><li><a href="Glossary.html"><strong aria-hidden="true">11.</strong> Glossary</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title"><img src="theme/images/tari-horizontal-logo.png"/> </h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#rfc-0130mining" id="rfc-0130mining"><h1>RFC-0130/Mining</h1></a>
<a class="header" href="#full-node-mining-on-tari-base-layer" id="full-node-mining-on-tari-base-layer"><h2>Full-node mining on Tari base layer</h2></a>
<p><img src="theme/images/status-draft.svg" alt="status: draft" /></p>
<p><strong>Maintainer(s)</strong>: [Yuko Roodt] (https://github.com/neonknight64)</p>
<a class="header" href="#license" id="license"><h1>License</h1></a>
<p><a href="https://opensource.org/licenses/BSD-3-Clause"> The 3-Clause BSD License</a>.</p>
<p>Copyright 2018 The Tari Development Community</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
following conditions are met:</p>
<ol>
<li>Redistributions of this document must retain the above copyright notice, this list of conditions and the following
disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following
disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products
derived from this software without specific prior written permission.</li>
</ol>
<p>THIS DOCUMENT IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<a class="header" href="#language" id="language"><h2>Language</h2></a>
<p>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;,
&quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be interpreted as described in
<a href="https://tools.ietf.org/html/bcp14">BCP 14</a> (covering RFC2119 and RFC8174) when, and only when, they appear in all
capitals, as shown here.</p>
<a class="header" href="#disclaimer" id="disclaimer"><h2>Disclaimer</h2></a>
<p>The purpose of this document and its content is for information purposes only and may be subject to change or update
without notice.</p>
<p>This document may include preliminary concepts that may or may not be in theprocess of being developed by the Tari
community. The release of this document is intended solely for review and discussion by the community regarding the
technological merits of the potential system outlined herein.</p>
<a class="header" href="#goals" id="goals"><h2>Goals</h2></a>
<p>This document will provide a brief overview of the Tari merged mining process and will introduce the primary
functionality required of the Mining Server and Mining Worker.</p>
<a class="header" href="#related-rfcs" id="related-rfcs"><h2>Related RFCs</h2></a>
<ul>
<li><a href="RFC-0100_BaseLayer.html">RFC-0100: Base layer</a></li>
<li><a href="RFC-0110_BaseNodes.html">RFC-0110: Base nodes</a></li>
</ul>
<a class="header" href="#description" id="description"><h2>Description</h2></a>
<a class="header" href="#assumptions" id="assumptions"><h3>Assumptions</h3></a>
<ul>
<li>That the Tari <a href="Glossary.html#blockchain">blockchain</a> will be merged mined with Monero.</li>
<li>The Tari <a href="Glossary.html#base-layer">Base Layer</a> has a network of <a href="Glossary.html#base-node">Base Node</a>s that verify and propagate valid <a href="Glossary.html#transaction">transaction</a>s and <a href="Glossary.html#block">block</a>s.</li>
</ul>
<a class="header" href="#abstract" id="abstract"><h3>Abstract</h3></a>
<p>The process of merged mining Tari with Monero on the Tari Base Layer is performed by <a href="Glossary.html#mining-server">Mining Server</a>s and <a href="Glossary.html#mining-worker">Mining
Worker</a>s. Mining Servers are responsible for constructing new blocks by bundling transactions from the <a href="Glossary.html#mempool">mempool</a>
of a connected Base Node. They then distribute Proof-of-Work(PoW) tasks to Mining Workers in an attempt to solve
newly created blocks. Solved solutions and shares are sent by the Mining Workers to the Mining Server, who in turns
verifies the solution and distributes the newly created blocks to the Base Node and Monero Node for inclusion in
their respective blockchains.</p>
<a class="header" href="#merged-mining-on-the-tari-base-layer" id="merged-mining-on-the-tari-base-layer"><h3>Merged mining on the Tari Base Layer</h3></a>
<p>This document is divided into three parts. First, a brief overview of the merged mining process and the interactions
between the Base Node, Mining Server and Mining Worker will be provided, then the primary functionality required
of the Mining Server and Mining Worker will be proposed.</p>
<a class="header" href="#overview-of-the-tari-merged-mining-process-using-mining-servers-and-mining-workers" id="overview-of-the-tari-merged-mining-process-using-mining-servers-and-mining-workers"><h4>Overview of the Tari merged mining process using Mining Servers and Mining Workers</h4></a>
<p>Mining on the Tari Base Layer consists of three primary entities: the Base Nodes, Mining Servers and Mining Workers.
A description of the Base Node is provided in [RFC-0110/Base Nodes] (https://tari-project.github.io/tari/RFC-0110_BaseNodes.html).
A Mining Server is connected locally or remotely to a Tari Base Node and a Monero Node, and is responsible for
constructing Tari and Monero Blocks from their respective mempools. The Mining Server should retrieve transactions
from the mempool of the connected Base Node and assemble a new Tari block by bundling transactions together.</p>
<p>Mining servers may re-verify transactions before including them in a new Tari block, but this enforcement of
verification and transaction rules such as signatures and timelocks are the responsibility of the connected Base node. Mining servers are responsible for <a href="RFC-0140_Syncing.html#Pruning-and-cut-through">cut-through</a> as this is required for scalability and privacy.</p>
<p>To enable Merged mining of Tari with Monero, both a Tari and a Monero block needs to be created and linked. First,
a new Tari block is created and then the block header hash of the new Tari block is included in the coinbase
transaction of the new Monero block. Once a new merged mined Monero block has been constructed, PoW tasks can then
be sent to the connected Mining Workers that will attempt to solve the block by performing the latest released
version of the PoW algorithm selected by Monero.</p>
<p>Assuming the Tari difficulty is less than the Monero difficulty, miners get rewarded for solving the PoW at any
difficulty above the Tari difficulty. If the block is solved above the Tari difficulty, a new Tari block is mined.
If the difficulty is also greater than the Monero difficulty, a new Monero block is mined as well. In either event,
the header for the candidate Monero block is included in the Tari block header.</p>
<p>If the PoW solution was sufficient to meet the difficult level of both the Tari and Monero blockchains, then the
individual blocks for each blockchain can be sent from the Mining Server to the Base Node and Monero Node to be
added to the respective blockchains.</p>
<p>Every Tari block must include the solved Monero block’s information (block header hash, Merkle tree branch, and
hash of the coinbase transaction) into the PoW summary section of the Tari block header.
If the PoW solution found by the Mining Workers only solved the problem at the Tari difficulty, the Monero block can be discarded.</p>
<p>This process will ensure that the Tari difficulty remains independent. Adjusting the difficulty will ensure that
the Tari block times are preserved. Also, the Tari block time can be less than, equal
or greater than the Monero block times. A more detailed description of the Merged Mining process between a Primary
and Auxiliary blockchain is provided in the [Merged Mining TLU report] (https://tlu.tarilabs.com/merged-mining/merged-mining.html).</p>
<a class="header" href="#functionality-required-by-the-tari-mining-server" id="functionality-required-by-the-tari-mining-server"><h4>Functionality required by the Tari Mining Server</h4></a>
<ul>
<li>The Tari blockchain MUST have the ability to be merged mined with Monero.</li>
<li>The Mining Server MUST maintain a local or remote connection with a Base Node and a Monero Node.</li>
<li>It MUST have a mechanism to construct a new Tari and Monero block by selecting transactions from the different
Tari and Monero mempools that need to be included in the different blocks.</li>
<li>It MUST apply <a href="RFC-0140_Syncing.html#Pruning-and-cut-through">cut-through</a> when mining Tari transactions from the <a href="Glossary.html#mempool">mempool</a> and only add the excess to the list of new  Tari block transactions.</li>
<li>It MAY have a configurable transaction selection mechanism for the block construction process.</li>
<li>It MAY have the ability to re-verify transactions before including them in a new Tari block.</li>
<li>It MUST have the ability to include the block header hash of the new Tari block into the coinbase section of a
newly created Monero block to enable merged mining.</li>
<li>It MUST be able to include the Monero block header hash, Merkle tree branch and hash of the coinbase transaction
of the Monero block into the PoW summary field of the new Tari block header.</li>
<li>It MUST have the ability to transmit and distribute PoW tasks for the newly created Monero block, that contains
the Tari block information, to connected Mining Workers.</li>
<li>It MUST verify PoW solutions received from Mining Workers and it MUST reject and discard invalid solutions or
solutions that do not meet the minimum required difficulty.</li>
<li>The Mining Server MAY keep track of mining share contributions of the connected Mining Workers.</li>
<li>It MUST submit completed Tari blocks to the Tari Base Node.</li>
<li>It MUST submit completed Monero blocks to the Monero Network.</li>
</ul>
<a class="header" href="#functionality-required-by-the-tari-mining-worker" id="functionality-required-by-the-tari-mining-worker"><h4>Functionality required by the Tari Mining Worker</h4></a>
<ul>
<li>It MUST maintain a local or remote connection to a Mining Server.</li>
<li>It MUST have the ability to receive PoW tasks from the connected Mining Server.</li>
<li>It MUST have the ability to perform the latest released version of Monero's PoW algorithm on the received PoW tasks.</li>
<li>It MUST attempt to solve the PoW task at the difficulty specified by the Mining Server.</li>
<li>It MUST submit completed shares to the connected Mining Server.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="RFC-0110_BaseNodes.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="RFC-0140_Syncing_and_seeding.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="RFC-0110_BaseNodes.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="RFC-0140_Syncing_and_seeding.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Initialize mermaid -->
        <script src="theme/js/mermaid.min.js" type="text/javascript" charset="utf-8"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
